# URL Shortener Lab02 - Feature Nginx Layer

A production-ready, containerized URL shortening service built with Node.js, Express, MongoDB, and Nginx as a reverse proxy layer. This project demonstrates modern microservices architecture with containerization, load balancing, and comprehensive monitoring capabilities.

## ğŸ—ï¸ Architecture Overview

### System Architecture Diagram
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Docker Compose Environment                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                           Network Layer                                        â”‚ â”‚
â”‚  â”‚                      url-shortener-network                                     â”‚ â”‚
â”‚  â”‚                         (Bridge Driver)                                       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  NGINX LAYER     â”‚  â”‚     APPLICATION LAYER     â”‚  â”‚      DATA LAYER         â”‚ â”‚
â”‚  â”‚  (Port 80)       â”‚  â”‚      (Port 3000)          â”‚  â”‚     (Port 27017)        â”‚ â”‚
â”‚  â”‚                  â”‚  â”‚                           â”‚  â”‚                          â”‚ â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ â”‚ nginx:alpine â”‚ â”‚  â”‚  â”‚   node:18-alpine    â”‚  â”‚  â”‚ â”‚    mongo:latest      â”‚ â”‚
â”‚  â”‚ â”‚              â”‚ â”‚  â”‚  â”‚                     â”‚  â”‚  â”‚ â”‚                      â”‚ â”‚
â”‚  â”‚ â”‚ Reverse      â”‚ â”‚  â”‚  â”‚ Express.js Server   â”‚  â”‚  â”‚ â”‚ MongoDB Database     â”‚ â”‚
â”‚  â”‚ â”‚ Proxy        â”‚â—„â”€â”¼â”€â”€â”¼â”€â”€â”¤ RESTful API        â”‚â—„â”€â”¼â”€â”€â”¼â”€â”¤ Document Store       â”‚ â”‚
â”‚  â”‚ â”‚ Load         â”‚  â”‚  â”‚  â”‚ Business Logic     â”‚  â”‚  â”‚ â”‚ Persistent Storage   â”‚ â”‚
â”‚  â”‚ â”‚ Balancer     â”‚  â”‚  â”‚  â”‚ Health Monitoring  â”‚  â”‚  â”‚ â”‚                      â”‚ â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚           â”‚                          â”‚                            â”‚                â”‚
â”‚           â”‚                          â”‚                            â”‚                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ nginx_logs Volume â”‚    â”‚  Application Volume   â”‚    â”‚  mongodb_data Volume  â”‚ â”‚
â”‚  â”‚ /var/log/nginx    â”‚    â”‚  /app (live reload)   â”‚    â”‚  /data/db             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

External Access:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     HTTP/HTTPS     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client/User   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  localhost:80    â”‚
â”‚  (Browser/API)  â”‚                    â”‚  (Nginx Entry)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Component Interaction Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            Request/Response Flow                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. URL Creation Flow:
Client â”€â”€POST /urlsâ”€â”€â–º Reverse Proxy â”€â”€forwardâ”€â”€â–º API Server â”€â”€â–º Document Database
   â”‚                     â”‚                          â”‚                    â”‚
   â”‚                     â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                     â”‚         â”‚              Processing Chain                  â”‚
   â”‚                     â”‚         â”‚                                                â”‚
   â”‚                     â”‚         â”‚  Route Handler â”€â”€â–º HTTP Controller            â”‚
   â”‚                     â”‚         â”‚       â”‚                â”‚                      â”‚
   â”‚                     â”‚         â”‚       â”‚                â–¼                      â”‚
   â”‚                     â”‚         â”‚       â”‚         Business Logic                â”‚
   â”‚                     â”‚         â”‚       â”‚         - ID Generation               â”‚
   â”‚                     â”‚         â”‚       â”‚         - URL Shortening              â”‚
   â”‚                     â”‚         â”‚       â”‚                â”‚                      â”‚
   â”‚                     â”‚         â”‚       â”‚                â–¼                      â”‚
   â”‚                     â”‚         â”‚       â”‚         Data Model (ODM)             â”‚
   â”‚                     â”‚         â”‚       â”‚         - Schema validation           â”‚
   â”‚                     â”‚         â”‚       â”‚         - Database persistence        â”‚
   â”‚                     â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚                     â”‚                 â”‚                â”‚
   â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
   JSON Response                                             â”‚
   {"shortUrl": "http://localhost/aBc123D"}                  â”‚
                                                             â”‚
2. URL Redirection Flow:                                     â”‚
Client â”€â”€GET /aBc123Dâ”€â”€â–º Reverse Proxy â”€â”€forwardâ”€â”€â–º API Server â”€â”€â–º Document Database
   â”‚                       â”‚                         â”‚                â”‚
   â”‚                       â”‚                         â”‚                â”‚
   â”‚                       â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                       â”‚         â”‚           Redirection Chain             â”‚
   â”‚                       â”‚         â”‚                                         â”‚
   â”‚                       â”‚         â”‚  Route Handler â”€â”€â–º HTTP Controller     â”‚
   â”‚                       â”‚         â”‚       â”‚                â”‚               â”‚
   â”‚                       â”‚         â”‚       â”‚                â–¼               â”‚
   â”‚                       â”‚         â”‚       â”‚         Business Logic        â”‚
   â”‚                       â”‚         â”‚       â”‚         - URL Resolution      â”‚
   â”‚                       â”‚         â”‚       â”‚         - Analytics Update    â”‚
   â”‚                       â”‚         â”‚       â”‚                â”‚               â”‚
   â”‚                       â”‚         â”‚       â”‚                â–¼               â”‚
   â”‚                       â”‚         â”‚       â”‚         Data Model            â”‚
   â”‚                       â”‚         â”‚       â”‚         - Document Query      â”‚
   â”‚                       â”‚         â”‚       â”‚         - Counter Increment   â”‚
   â”‚                       â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚                       â”‚                 â”‚                â”‚
   â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
   301 Redirect to original URL                              â”‚
                                                             â”‚
3. Health Check Flow:                                        â”‚
Client â”€â”€GET /healthâ”€â”€â–º Reverse Proxy â”€â”€forwardâ”€â”€â–º API Server
   â”‚                      â”‚                        â”‚
   â”‚                      â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚                      â”‚            â”‚     Health Monitor      â”‚
   â”‚                      â”‚            â”‚                         â”‚
   â”‚                      â”‚            â”‚ - Process uptime        â”‚
   â”‚                      â”‚            â”‚ - Current timestamp     â”‚
   â”‚                      â”‚            â”‚ - Service status        â”‚
   â”‚                      â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚                      â”‚                        â”‚
   â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   JSON Response
   {"status": "healthy", "timestamp": "...", "uptime": 123.45}
```

### Technical Specifications

| Component | Technology | Version | Port | Memory | CPU | Purpose |
|-----------|------------|---------|------|--------|-----|---------|
| **Nginx** | nginx:alpine | Latest | 80 (external) | ~10MB | Low | Reverse Proxy, Load Balancer, Static Content |
| **API Server** | node:18-alpine | 18.x | 3000 (internal) | ~50MB | Medium | REST API, Business Logic, Request Processing |
| **Database** | mongo:latest | 7.x | 27017 (internal/external) | ~100MB | Medium | Document Storage, Data Persistence |

### Core Features Matrix

| Feature | Implementation | Status | Details |
|---------|---------------|--------|---------|
| **URL Shortening** | 7-character alphanumeric IDs | âœ… Active | Random ID generation with 62-character charset |
| **URL Redirection** | 301 redirects with analytics | âœ… Active | Automatic visit tracking with database updates |
| **Health Monitoring** | Multi-layer health checks | âœ… Active | Container health checks + health endpoint |
| **Error Handling** | Comprehensive validation | âœ… Active | URL validation, 404/500 error responses |
| **Containerization** | Docker + Docker Compose | âœ… Active | Multi-container orchestration with networking |
| **Reverse Proxy** | Load balancing | âœ… Active | Upstream backend configuration |
| **Logging** | Structured logging | âœ… Active | JSON formatted logs with timestamps |
| **Data Persistence** | Document database with volumes | âœ… Active | Named volumes for data and logs |

### API Specification

| Method | Endpoint | Request Body | Response | Status Codes | Purpose |
|--------|----------|-------------|----------|-------------|---------|
| `POST` | `/urls` | `{"longUrl": "https://example.com"}` | `{"shortUrl": "http://localhost/aBc123D"}` | 201, 400, 500 | Create short URL |
| `GET` | `/:shortUrlId` | None | 301 Redirect to original URL | 301, 404, 500 | Redirect to original |
| `GET` | `/health` | None | `{"status": "healthy", "timestamp": "...", "uptime": 123.45}` | 200 | Service health check |

### Database Schema

```
Document Structure:
{
  shortUrlId: String,    // 7-character unique identifier (indexed)
  longUrl: String,       // Original URL (validated)
  createdAt: Date,       // Auto-generated timestamp
  visits: Number         // Analytics counter (auto-incremented)
}

Collection: urls
Indexes: _id (default), shortUrlId (unique B-tree)
```

### Environment Configuration

```
Application Configuration:
- PORT: 3000 (internal container port)
- MONGO_URI: Internal container DNS resolution
- BASE_URL: Base URL for short link generation

Docker Environment Variables:
- PORT=3000
- MONGO_URI=mongodb://mongodb:27017/url_shortener  
- BASE_URL=http://localhost
```

## ğŸ—ï¸ Detailed Architecture Analysis

### Container Architecture Deep Dive

#### 1. **Reverse Proxy Layer (Lightweight Alpine)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Reverse Proxy Container                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              HTTP Configuration                     â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  Event-driven Architecture:                        â”‚    â”‚
â”‚  â”‚    worker_connections: 1024                        â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  HTTP Module:                                       â”‚    â”‚
â”‚  â”‚    upstream backend {                              â”‚    â”‚
â”‚  â”‚      server api_server:3000                        â”‚    â”‚
â”‚  â”‚    }                                               â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚    server block {                                   â”‚    â”‚
â”‚  â”‚      listen: 80                                     â”‚    â”‚
â”‚  â”‚      proxy_pass: upstream backend                   â”‚    â”‚
â”‚  â”‚    }                                               â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  External Port 80 â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Internal Communication  â”‚
â”‚  Volume: proxy_logs:/var/log/proxy                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Key Features:**
- **Load Balancing**: Single upstream server (scalable to multiple)
- **Reverse Proxy**: All requests forwarded to API server container
- **Alpine Linux**: Minimal 5MB base image
- **Log Persistence**: Proxy logs stored in named volume

#### 2. **Application Container (Lightweight Node.js Runtime)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Web API Application Container                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                        Web Framework Application                        â”‚    â”‚
â”‚  â”‚                                                                         â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚   Server Boot   â”‚  â”‚   Middleware     â”‚  â”‚     Routes           â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                 â”‚  â”‚                  â”‚  â”‚                      â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ â”‚HTTP Server  â”‚ â”‚  â”‚ â”‚JSON Parser   â”‚ â”‚  â”‚ â”‚POST /urls        â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ â”‚Port: 3000   â”‚ â”‚  â”‚ â”‚Request Loggerâ”‚ â”‚  â”‚ â”‚GET /:shortUrlId  â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ â”‚DB Connectionâ”‚ â”‚  â”‚ â”‚Error Handler â”‚ â”‚  â”‚ â”‚GET /health       â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                                 â”‚                       â”‚               â”‚    â”‚
â”‚  â”‚                                 â–¼                       â–¼               â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚                     HTTP Controllers Layer                         â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  Request Handlers:                                                  â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ createShortUrl()    â”‚  â”‚ redirectToLongUrl()                  â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - Validate input    â”‚  â”‚ - Extract ID from params             â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - Call business     â”‚  â”‚ - Call business layer                â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - Return response   â”‚  â”‚ - Send 301 redirect                  â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - Handle errors     â”‚  â”‚ - Handle 404/500 errors              â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                                 â”‚                                           â”‚    â”‚
â”‚  â”‚                                 â–¼                                           â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚                      Business Logic Layer                          â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  Core Functions:                                                    â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ generateShortUrlId():                                          â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - 62-character alphabet (A-Z, a-z, 0-9)                       â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - 7-character random string generation                         â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - 62^7 = 3.5+ trillion possible combinations                   â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ shortenUrl(longUrl):                                           â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - Generate unique shortUrlId                                   â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - Create new document                                          â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - Save to database                                             â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - Return formatted shortUrl                                    â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ getLongUrl(shortUrlId):                                        â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - Query database for shortUrlId                                â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - Increment visit counter                                      â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - Update document in database                                  â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ - Return original longUrl                                      â”‚ â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                                 â”‚                                           â”‚    â”‚
â”‚  â”‚                                 â–¼                                           â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚                       Data Model Layer                             â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                                                                     â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  Database Schema (Object Document Mapper):                         â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚ Document Schema Definition:                                 â”‚   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   shortUrlId: String (unique index)                        â”‚   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   longUrl: String (required)                               â”‚   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   createdAt: Date (auto-timestamp)                         â”‚   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â”‚   visits: Number (analytics counter)                       â”‚   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                                                                         â”‚    â”‚
â”‚  â”‚  Structured Logger: JSON formatted logs with timestamps                 â”‚    â”‚
â”‚  â”‚  Health Check: /health endpoint with uptime and timestamp              â”‚    â”‚
â”‚  â”‚  Error Handling: Global error middleware with 500 responses            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                                 â”‚
â”‚  Internal Port 3000 â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Database Connection                           â”‚
â”‚  Volume: /app (development live reload), /app/node_modules                     â”‚
â”‚  Environment: PORT=3000, MONGO_URI, BASE_URL                                   â”‚
â”‚  Health Check: curl -f http://localhost:3000/health every 30s                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3. **Database Container (Document Store)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Document Database Container              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                Database Structure                   â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  Database: url_shortener                           â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚           Collection: urls                  â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                                             â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  Documents Structure:                       â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  {                                          â”‚   â”‚    â”‚
â”‚  â”‚  â”‚    _id: ObjectId("..."),                    â”‚   â”‚    â”‚
â”‚  â”‚  â”‚    shortUrlId: "aBc123D",     â—„â”€â”€ Unique    â”‚   â”‚    â”‚
â”‚  â”‚  â”‚    longUrl: "https://...",                  â”‚   â”‚    â”‚
â”‚  â”‚  â”‚    createdAt: ISODate("..."),               â”‚   â”‚    â”‚
â”‚  â”‚  â”‚    visits: 42,                              â”‚   â”‚    â”‚
â”‚  â”‚  â”‚    __v: 0                                   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  }                                          â”‚   â”‚    â”‚
â”‚  â”‚  â”‚                                             â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  Indexes:                                   â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  - _id (default)                            â”‚   â”‚    â”‚
â”‚  â”‚  â”‚  - shortUrlId (unique)                      â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â”‚  Connection String:                                 â”‚    â”‚
â”‚  â”‚  mongodb://database_server:27017/url_shortener     â”‚    â”‚
â”‚  â”‚                   â–²         â–²                       â”‚    â”‚
â”‚  â”‚              DNS Name    Database                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                             â”‚
â”‚  Port 27017 (Internal + External for development)          â”‚
â”‚  Volume: database_data:/data/db (persistent storage)       â”‚
â”‚  Auto-restart: unless-stopped                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Network Communication Detailed Analysis

#### Container Network: `url-shortener-network`
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Bridge Network (Internal Container Network)                 â”‚
â”‚                                                                                 â”‚
â”‚  Container Internal DNS Resolution:                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚  â”‚reverse_proxyâ”‚â”€â”€â”€â”€â–¶â”‚ api_server  â”‚â”€â”€â”€â”€â–¶â”‚  database   â”‚                      â”‚
â”‚  â”‚  proxy:80   â”‚     â”‚ server:3000 â”‚     â”‚  db:27017   â”‚                      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                                 â”‚
â”‚  External Access:                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                           â”‚
â”‚  â”‚  Host:80  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚ (localhost)     â”‚                                     â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                     â”‚                     â”‚
â”‚                                                          â”‚                     â”‚
â”‚  Port Mapping:                                           â”‚                     â”‚
â”‚  - reverse_proxy: 80:80 (host:container)                 â–¼                     â”‚
â”‚  - database: 27017:27017 (development access)   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  - api_server: No external port (internal only) â”‚reverse_proxyâ”‚                â”‚
â”‚                                                  â”‚   :80       â”‚                â”‚
â”‚                                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Flow Analysis

#### 1. URL Shortening Request Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            POST /urls Request                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 1: Client Request
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ POST /urls      â”‚
â”‚ Content-Type:   â”‚
â”‚ application/jsonâ”‚
â”‚ Body: {         â”‚
â”‚   "longUrl":    â”‚
â”‚   "https://..." â”‚
â”‚ }               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
Step 2: Reverse Proxy    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚               â”‚ HTTP Configuration                      â”‚
         â–¼               â”‚ upstream backend { server api:3000; }   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚ location / {                            â”‚
â”‚ reverse_proxy   â”‚      â”‚   proxy_pass http://backend;            â”‚
â”‚ proxy_pass      â”‚      â”‚ }                                       â”‚
â”‚ http://backend  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
Step 3: Route Resolution
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP Route Mapping                                              â”‚
â”‚ router.post('/urls', createShortUrl);                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
Step 4: Controller Processing
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ HTTP Request Handler                                            â”‚
â”‚                                                                 â”‚
â”‚ URL Creation Process:                                           â”‚
â”‚   - Extract longUrl from request body                          â”‚
â”‚   - Validate URL format (must start with http:// or https://)  â”‚
â”‚   - Call business logic layer                                  â”‚
â”‚   - Return shortUrl response                                   â”‚
â”‚   - Handle 400/500 error cases                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
Step 5: Business Logic Processing
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Core Business Operations                                        â”‚
â”‚                                                                 â”‚
â”‚ URL Shortening Algorithm:                                       â”‚
â”‚   - Generate 7-character random ID                             â”‚
â”‚   - Create new document object                                 â”‚
â”‚   - Persist to database                                        â”‚
â”‚   - Format and return complete short URL                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
Step 6: Database Operation
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Database Persistence                                            â”‚
â”‚                                                                 â”‚
â”‚ Document Creation:                                              â”‚
â”‚   shortUrlId: "aBc123D"                                         â”‚
â”‚   longUrl: "https://example.com"                               â”‚
â”‚   createdAt: new Date()                                        â”‚
â”‚   visits: 0                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
Step 7: Response Chain
         â–¼
Client â—„â”€â”€ Reverse Proxy â—„â”€â”€ API Server â—„â”€â”€ {"shortUrl": "http://localhost/aBc123D"}
```

#### 2. URL Redirection Request Flow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        GET /:shortUrlId Request                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 1: Client Request
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /aBc123D    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
Step 2: Reverse Proxy (same as above)
         â–¼
Step 3: Route Resolution
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Dynamic Route Matching                                          â”‚
â”‚ router.get('/:shortUrlId', redirectToLongUrl);                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
Step 4: Controller Processing
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Redirection Handler                                             â”‚
â”‚                                                                 â”‚
â”‚ URL Resolution Process:                                         â”‚
â”‚   - Extract shortUrlId from URL parameters                     â”‚
â”‚   - Call business logic to resolve URL                         â”‚
â”‚   - Send 301 permanent redirect response                       â”‚
â”‚   - Handle 404/500 error cases                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
Step 5: Business Logic Processing
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ URL Resolution & Analytics                                      â”‚
â”‚                                                                 â”‚
â”‚ Lookup and Analytics Process:                                  â”‚
â”‚   - Query database by shortUrlId                               â”‚
â”‚   - Increment visit counter                                    â”‚
â”‚   - Update document in database                                â”‚
â”‚   - Return original longUrl                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
Step 6: Database Operations
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Database Lookup & Update                                        â”‚
â”‚                                                                 â”‚
â”‚ Operations:                                                     â”‚
â”‚   1. Query: findOne({ shortUrlId: "aBc123D" })                 â”‚
â”‚   2. Update: increment visits counter                          â”‚
â”‚   3. Save updated document                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
Step 7: HTTP Redirect Response
         â–¼
Client â—„â”€â”€ 301 Redirect
           Location: https://example.com
```

## ğŸ“‹ Implementation Details

### Container Configuration Analysis

#### **Multi-Container Orchestration**
```yaml
Services Architecture:
  reverse_proxy:
    - Custom build with configuration
    - External HTTP access port 80
    - Depends on API server availability
    - Internal container networking
    - Persistent log storage

  api_server:
    - Application runtime build
    - Internal port 3000 only
    - Environment configuration
    - Database dependency
    - Live code reload capability
    - Container health monitoring

  database:
    - Official document database image
    - Internal + external port access
    - Persistent data storage
    - Internal container networking

Volume Management:
  - database_data: Persistent database storage
  - proxy_logs: Reverse proxy log storage

Network Architecture:
  - Internal bridge network
  - Container DNS resolution
  - Isolated from host network
```

#### **Application Container Build Process**
```dockerfile
Build Strategy:
FROM lightweight_runtime:18-alpine
WORKDIR /app
COPY package*.json ./          # Dependency layer caching
RUN install_dependencies       # Install application dependencies  
COPY . .                       # Copy application source code
EXPOSE 3000                    # Document internal port
CMD ["start_command"]          # Application startup command
```

#### **Reverse Proxy Configuration**
```
HTTP Server Configuration:
- Event-driven architecture with worker connections: 1024
- Upstream backend server configuration
- Location-based request forwarding
- HTTP port 80 listener
- Proxy pass to internal backend
- Log directory creation
- Foreground daemon execution
```

### Application Architecture Layers

#### **Main Application Entry Point**
- Web framework initialization
- Structured logging configuration with JSON formatting and timestamps
- Middleware stack: JSON parsing, request logging, error handling
- Health check endpoint: Returns service status, timestamp, and uptime
- Route mounting and global error handling
- Database connection with error handling and logging
- Server startup on configured port

#### **Environment Configuration Management**
- Environment variable loading from system
- Application port configuration with defaults
- Database connection string configuration
- Base URL configuration for short link generation
- Production/development environment support

#### **Data Model Layer**
- Document schema definition with field types and constraints
- Unique indexing strategy for fast lookups
- Auto-timestamping for creation tracking
- Analytics counter for visit tracking
- Input validation and data persistence

#### **Business Logic Layer**
- 7-character ID generation using 62-character alphabet (A-Z, a-z, 0-9)
- 62^7 = 3.5+ trillion possible combinations for collision avoidance
- URL shortening: ID generation, document creation, database persistence
- URL resolution: Database lookup, analytics update, original URL return
- Error handling for not found cases

#### **HTTP Request Handlers**
- POST /urls: Input validation, business logic calls, JSON responses, error handling
- GET /:shortUrlId: Parameter extraction, URL resolution, 301 redirects, 404 handling
- Standardized HTTP status codes: 200, 201, 301, 400, 404, 500

#### **Route Definitions**
- URL creation endpoint mapping
- Dynamic route for redirection with parameter capture
- Route pattern matching for 7-character alphanumeric strings

#### **Reverse Proxy Configuration**
- Event-driven worker configuration with 1024 connections
- Upstream backend server definition
- Simple reverse proxy with all requests forwarded to API server
- No SSL/HTTPS configuration (development setup)
- No caching configuration - all requests processed by application


## Features

- âœ… URL shortening with 7-character alphanumeric IDs
- âœ… URL redirection with visit tracking
- âœ… Nginx reverse proxy configuration
- âœ… Complete Docker containerization
- âœ… Health check endpoints with uptime monitoring
- âœ… Structured logging with Winston
- âœ… MongoDB persistence with Mongoose ODM
- âœ… Environment-based configuration
- âœ… Input validation for URLs

## Quick Start

1. **Clone and navigate to the project**
```bash
git clone https://github.com/poridhioss/url-shortener-lab02.git
cd url-shortener-lab02
```

2. **Start all services with Docker Compose**
```bash
docker-compose up --build -d
```

3. **Verify all containers are running**
```bash
docker-compose ps
```

4. **Test the health endpoint**
```bash
curl http://localhost/health
```

## API Endpoints

### Health Check
```bash
GET /health
```
Returns service status, timestamp, and uptime.

**Response:**
```json
{
  "status": "healthy",
  "timestamp": "2025-08-21T10:30:00.000Z",
  "uptime": 120.45
}
```

### Create Short URL
```bash
POST /urls
Content-Type: application/json

{
  "longUrl": "https://www.example.com"
}
```

**Response:**
```json
{
  "shortUrl": "http://localhost/a1B2c3D"
}
```

### Redirect to Original URL
```bash
GET /:shortUrlId
```
Redirects to the original URL and increments visit counter.

## Service Configuration

### Container Services

- **reverse_proxy**: HTTP reverse proxy (Port 80)
  - Custom build with configuration
  - Proxies requests to the API server
  - Logs stored in named volume

- **api_server**: Web API application (Port 3000, internal)
  - Application runtime build
  - Health checks every 30 seconds
  - Auto-restart on failure

- **database**: Document database (Port 27017)
  - Official database image
  - Data persisted in named volume
  - Connected via internal network

### Environment Variables

The application uses the following environment variables:

- `PORT`: Application port (default: 3000)
- `MONGO_URI`: Database connection string (internal container DNS)
- `BASE_URL`: Base URL for generated short URLs (http://localhost)

### Reverse Proxy Configuration

Internal proxy configuration:
- Upstream backend pointing to api_server:3000
- Simple reverse proxy configuration
- 1024 worker connections

## Application Architecture

```
Containerized URL Shortener Service/
â”œâ”€â”€ Container Orchestration Config     # Multi-container orchestration
â”œâ”€â”€ Application Container Build        # API server container
â”œâ”€â”€ Dependency Management              # Application dependencies and scripts
â”œâ”€â”€ Package Lock                       # Locked dependency versions
â”œâ”€â”€ Version Control Config             # Git ignore rules
â”œâ”€â”€ Reverse Proxy/
â”‚   â”œâ”€â”€ Container Build Config         # Proxy container configuration
â”‚   â””â”€â”€ HTTP Configuration             # Reverse proxy config
â””â”€â”€ Source Code/
    â”œâ”€â”€ Application Entry Point        # Web server and app initialization
    â”œâ”€â”€ Configuration/
    â”‚   â””â”€â”€ Environment Config         # Environment configuration management
    â”œâ”€â”€ HTTP Controllers/
    â”‚   â””â”€â”€ Request Handlers           # HTTP request handlers
    â”œâ”€â”€ Data Models/
    â”‚   â””â”€â”€ Schema Definition          # Database schema definition
    â”œâ”€â”€ API Routes/
    â”‚   â””â”€â”€ Endpoint Definitions       # API route definitions
    â””â”€â”€ Business Logic/
        â””â”€â”€ Core Operations            # Business logic and URL operations
```

## Database Schema

### URL Document Model
```
Document Structure:
{
  shortUrlId: String,    // 7-character unique identifier (indexed)
  longUrl: String,       // Original URL (validated)
  createdAt: Date,       // Auto-generated timestamp
  visits: Number         // Analytics counter (auto-incremented)
}

Collection: urls
Indexes: _id (default), shortUrlId (unique B-tree)
```

## Development

### Local Development (without containers)
- Install application dependencies
- Set environment variables for database connection and base URL
- Start development server with auto-reload capability
- Or start production server

### Container Development
- Build and start all services with orchestration
- Start in background mode
- View logs from all services or specific services
- Stop all services
- Stop and remove persistent volumes

## Testing Examples

### Create and Use Short URL
- Create a short URL via POST request with JSON payload
- Expected response contains the generated short URL
- Test the redirect functionality with follow redirects
- Test redirect headers only for validation

### Health and Monitoring
- Check service health endpoint
- Check container status
- View real-time logs from application

## Error Handling

The application includes comprehensive error handling:

- **400 Bad Request**: Invalid URL format (must start with http:// or https://)
- **404 Not Found**: Short URL ID not found in database
- **500 Internal Server Error**: Database connection issues or server errors

## Dependencies

### Production Dependencies
- **Web Framework**: Modern web application framework
- **Database ODM**: Document database object modeling
- **Environment Config**: Environment variable management
- **Structured Logging**: Production-grade logging library

### Development Dependencies
- **Development Server**: Auto-reload development server

### Container Dependencies
- **Application Runtime**: Lightweight runtime environment
- **Reverse Proxy**: Lightweight HTTP reverse proxy
- **Document Database**: Latest document database

## Monitoring and Logs

### Application Logs
The application uses Winston for structured logging:
- JSON formatted logs with timestamps
- HTTP request logging middleware
- Error stack trace logging

### Container Health Checks
The Node.js app includes a health check:
- Endpoint: `GET /health`
- Interval: 30 seconds
- Timeout: 10 seconds
- Retries: 3
- Start period: 40 seconds

### Volume Management
- `mongodb_data`: Persistent MongoDB data
- `nginx_logs`: Nginx access and error logs

## Network Configuration

All services communicate via the `url-shortener-network` bridge network:
- Internal DNS resolution between containers
- Isolated from host network by default
- Only Nginx port 80 exposed to host

## ğŸ”§ Advanced Features & Monitoring

### Health Monitoring System

#### **Container Health Checks**
- Health check configuration with intervals and timeouts
- Health endpoint testing with startup grace periods
- Health status monitoring and failure detection
- Automatic container restart on health failures

#### **Health Endpoint Response**
- Service status indicator
- Current timestamp for verification
- Process uptime tracking in seconds

#### **Health Check Operations**
- Container health status verification
- Manual health endpoint testing
- Container log analysis for health check results

### Logging & Monitoring

#### **Structured Logger Configuration**
- JSON formatted logging with timestamps
- Configurable log levels and output formats
- Multiple transport options for log destinations
- Console logging for development and file logging for production

#### **Log Output Examples**
- Request logging with HTTP method and URL
- Database connection status logging
- Error logging with detailed timestamps
- Structured JSON format for log aggregation

#### **Monitoring Operations**
- View all container logs in real-time
- View specific service logs individually
- Filter logs by level (error, info, debug)
- Follow logs with timestamps for debugging

### Performance Analytics

#### **URL Visit Tracking**
- Automatic visit counter increment on each redirect
- Atomic counter updates to prevent race conditions
- Database document updates with visit statistics
- Analytics data persistence for reporting

#### **Database Query Optimization**
- Optimized database queries with proper indexing
- B-tree index on shortUrlId for O(log n) lookup time
- Database connection pooling for performance
- Aggregation pipelines for analytics queries

#### **Performance Monitoring Queries**
- Analytics aggregation for total URLs and visits
- Most visited URLs tracking
- Time-based URL creation analytics
- Database performance statistics

### Security Considerations

#### **URL Validation**
- Enhanced URL validation with proper format checking
- Protocol validation (HTTP/HTTPS only)
- Input sanitization and trimming
- XSS prevention through JSON-only API responses

#### **Rate Limiting (Future Enhancement)**
- Request rate limiting per IP address
- Configurable time windows and request limits
- Custom error messages for rate limit exceeded
- Middleware integration for URL creation endpoints

#### **Input Sanitization**
- URL sanitization before database storage
- Input trimming and normalization
- XSS prevention through JSON-only responses
- No HTML rendering - API-only service

### Error Handling & Resilience

#### **Global Error Handler**
- Comprehensive error handling middleware
- Error logging with context (URL, method, timestamp)
- Error stack trace logging for debugging
- Client-safe error responses without internal details

#### **Database Connection Resilience**
- Database connection with retry logic and timeouts
- Connection pool configuration for production
- Graceful shutdown on connection failures
- Buffer management and timeout configuration

#### **HTTP Status Codes**
- Standardized HTTP response codes for all endpoints
- 200: Service health check successful
- 201: URL created successfully  
- 301: Permanent redirect to original URL
- 400: Invalid URL format
- 404: Short URL not found
- 500: Internal server error

## ğŸš€ Deployment & Production

### Production Environment Setup

#### **Environment Variables**
- Production-specific port and database configurations
- Secure base URL with HTTPS domain
- Database authentication credentials
- Environment-specific logging and monitoring settings

#### **Production Container Configuration**
- Multi-service production orchestration
- HTTPS SSL certificate configuration
- Database authentication with username/password
- Auto-restart policies for high availability
      - "80:80"                             # HTTP redirect
    environment:
      - SSL_CERT_PATH=/etc/ssl/certs/
    volumes:
      - ./ssl:/etc/ssl/certs                # SSL certificates
      - nginx_logs:/var/log/nginx
    
  app:
    build: .
    environment:
      - NODE_ENV=production
      - PORT=3000
      - MONGO_URI=mongodb://mongodb:27017/url_shortener
    restart: unless-stopped                  # Auto-restart policy
    
  mongodb:
    image: mongo:latest
    environment:
      - MONGO_INITDB_ROOT_USERNAME=${MONGODB_USERNAME}
      - MONGO_INITDB_ROOT_PASSWORD=${MONGODB_PASSWORD}
    volumes:
      - mongodb_data:/data/db
      - ./mongo-init:/docker-entrypoint-initdb.d
    restart: unless-stopped
```

### Scaling & Load Balancing

#### **Multiple Application Instances**
- Horizontal scaling with multiple API server containers
- Load distribution across multiple service instances
- Container orchestration for service coordination
- Environment configuration for different ports

#### **Reverse Proxy Load Balancer Configuration**
- Multiple upstream servers with weighted load distribution
- Various load balancing algorithms (least connections, IP hash)
- SSL/HTTPS configuration with HTTP/2 support
- Security headers and compression settings
- Connection timeout configurations
- Health check endpoint optimization

### Database Optimization

#### **Production Database Configuration**
- Production-optimized connection pooling
- Connection lifecycle management with idle timeouts
- Server selection and socket timeout configuration
- Buffer management and command optimization

#### **Database Indexing Strategy**
- Compound indexes for complex query performance
- Time-based indexing for analytics queries
- TTL indexes for automatic data cleanup
- Query performance optimization strategies

### Monitoring & Alerting

#### **Application Metrics**
- Custom metrics collection and tracking
- Request counting and response code monitoring
- Error rate tracking and alerting
- Performance metrics endpoint
- Memory and uptime monitoring

#### **Container Health Monitoring**
- Health monitoring scripts for automation
- Health check status validation
- Automated restart on health failures
- Health status logging and alerting

### Backup & Disaster Recovery

#### **Database Backup Strategy**
- Automated database backup creation
- Backup compression and storage management
- Backup rotation and retention policies
- Disaster recovery procedures

#### **Automated Backup Scheduling**
- Cron-based backup automation
- Backup logging and monitoring
- Backup verification and integrity checks

## ğŸ“Š Testing & Quality Assurance

### API Testing Examples

#### **URL Creation Tests**
- Successful URL creation validation
- Invalid URL format testing
- Missing URL parameter handling
- Error response validation

#### **URL Redirection Tests**
- Successful redirection testing
- Non-existent URL handling
- Malformed short URL validation
- HTTP status code verification

#### **Health Check Tests**
- Health endpoint response validation
- Status and uptime verification
- Timestamp accuracy testing

### Load Testing

#### **Performance Testing**
- URL creation endpoint load testing
- Redirection endpoint performance testing
- Health endpoint stress testing
- Concurrent user simulation

#### **Stress Testing**
- Multi-phase load testing configuration
- Arrival rate ramping and stress phases
- Performance baseline establishment
      name: "Warm up"
    - duration: 300
      arrivalRate: 50
      ### Container Testing

#### **Container Health Verification**
- Container health status verification
- Internal container connectivity testing
- Resource usage monitoring
- Volume integrity verification

## ğŸ” Troubleshooting Guide

### Common Issues & Solutions

#### **Container Startup Issues**
- Application container startup failures
- Database connection error resolution
- Port conflict detection and resolution
- Missing environment variable identification

#### **Database Connection Issues**
- Network connectivity verification
- Database availability testing
- Connection string validation

#### **Reverse Proxy Issues**
- Gateway error troubleshooting
- Container communication verification
- Proxy configuration validation
- Upstream connectivity testing

#### **Performance Issues**
- Resource usage monitoring
- Database performance analysis
- Connection pool optimization

### Debug Operations

#### **Container Debugging**
- Container shell access for troubleshooting
- Process monitoring within containers
- Network configuration inspection

#### **Database Debugging**
- Database connection and query testing
- Collection statistics and indexing analysis
- Operation monitoring and query profiling

## ğŸ¯ Best Practices & Recommendations

### Development Best Practices

1. **Environment Separation**: Use different container configurations for development and production
2. **Security**: Never commit sensitive data like passwords or API keys
3. **Logging**: Implement structured logging with appropriate log levels
4. **Error Handling**: Always handle errors gracefully with proper HTTP status codes
5. **Testing**: Implement comprehensive testing including unit, integration, and load tests
6. **Monitoring**: Set up health checks and monitoring from day one
7. **Documentation**: Keep documentation up-to-date with code changes

### Production Deployment Checklist

- [ ] SSL/HTTPS configuration
- [ ] Environment variables properly configured
- [ ] Database authentication enabled
- [ ] Rate limiting implemented
- [ ] Monitoring and alerting set up
- [ ] Backup strategy implemented
- [ ] Load testing completed
- [ ] Security headers configured
- [ ] Log aggregation configured
- [ ] Container resource limits set

### Performance Optimization Tips

1. **Database Indexing**: Ensure proper indexes on frequently queried fields
2. **Connection Pooling**: Configure appropriate connection pool sizes
3. **Caching**: Implement Redis caching for frequently accessed URLs
4. **CDN**: Use CDN for static assets and global distribution
5. **Compression**: Enable compression in reverse proxy
6. **Resource Limits**: Set appropriate CPU and memory limits for containers
7. **Monitoring**: Continuously monitor performance metrics and optimize bottlenecks


